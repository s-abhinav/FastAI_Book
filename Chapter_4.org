#+Title: Fast AI - Chapter 4
#+PROPERTY: header-args:jupyter-python :session c4 :exports both

* import libraries
#+begin_src jupyter-python :results output silent
  from fastai.data.external import untar_data
  from fastai.data.external import URLs
  from fastai.vision.all import *
  from PIL import Image
  import numpy as np
  import pandas as pd
  import torch.nn.functional as F
#+end_src

* Load data
#+begin_src jupyter-python :exports code :results table
  path = untar_data(URLs.MNIST_SAMPLE)
  path
#+end_src

#+RESULTS:
| : Path('/Users/abhinav/.fastai/data/mnist_sample') |

* Load 3s and 7s

#+begin_src jupyter-python :results table :exports code
  threes = (path/'train'/'3').ls().sorted()
  sevens = (path/'train'/'7').ls().sorted()
  im3_path = threes[1]
  im3 = Image.open(im3_path)
  im3
#+end_src

#+RESULTS:
| [[file:./.ob-jupyter/348d31b9aee02bb71dd175c1b28ac7e09ed95ba1.jpg]] |

* PyTorch Tensor
#+begin_src jupyter-python :results replace raw
  im3_tensor = tensor(im3)
  im3_sliced = im3_tensor[4:10, 4:10]
  im3_sliced
#+end_src

#+RESULTS:
: tensor([[  0,   0,   0,   0,   0,   0],
:         [  0,   0,   0,   0,   0,  29],
:         [  0,   0,   0,  48, 166, 224],
:         [  0,  93, 244, 249, 253, 187],
:         [  0, 107, 253, 253, 230,  48],
:         [  0,   3,  20,  20,  15,   0]], dtype=torch.uint8)

#+begin_src jupyter-python :results
  df = pd.DataFrame(im3_tensor[4:15, 4:22].numpy())
  df.style.set_properties(**{'font-size':'6pt'}).background_gradient('Greys')
#+end_src

#+RESULTS:
#+begin_export html
<style type="text/css">
#T_ef289_row0_col0, #T_ef289_row0_col1, #T_ef289_row0_col2, #T_ef289_row0_col3, #T_ef289_row0_col4, #T_ef289_row0_col5, #T_ef289_row0_col6, #T_ef289_row0_col7, #T_ef289_row0_col8, #T_ef289_row0_col9, #T_ef289_row0_col10, #T_ef289_row0_col11, #T_ef289_row0_col12, #T_ef289_row0_col13, #T_ef289_row0_col14, #T_ef289_row0_col15, #T_ef289_row0_col16, #T_ef289_row0_col17, #T_ef289_row1_col0, #T_ef289_row1_col1, #T_ef289_row1_col2, #T_ef289_row1_col3, #T_ef289_row1_col4, #T_ef289_row1_col15, #T_ef289_row1_col16, #T_ef289_row1_col17, #T_ef289_row2_col0, #T_ef289_row2_col1, #T_ef289_row2_col2, #T_ef289_row2_col15, #T_ef289_row2_col16, #T_ef289_row2_col17, #T_ef289_row3_col0, #T_ef289_row3_col15, #T_ef289_row3_col16, #T_ef289_row3_col17, #T_ef289_row4_col0, #T_ef289_row4_col6, #T_ef289_row4_col7, #T_ef289_row4_col8, #T_ef289_row4_col9, #T_ef289_row4_col10, #T_ef289_row4_col15, #T_ef289_row4_col16, #T_ef289_row4_col17, #T_ef289_row5_col0, #T_ef289_row5_col5, #T_ef289_row5_col6, #T_ef289_row5_col7, #T_ef289_row5_col8, #T_ef289_row5_col9, #T_ef289_row5_col15, #T_ef289_row5_col16, #T_ef289_row5_col17, #T_ef289_row6_col0, #T_ef289_row6_col1, #T_ef289_row6_col2, #T_ef289_row6_col3, #T_ef289_row6_col4, #T_ef289_row6_col5, #T_ef289_row6_col6, #T_ef289_row6_col7, #T_ef289_row6_col8, #T_ef289_row6_col9, #T_ef289_row6_col14, #T_ef289_row6_col15, #T_ef289_row6_col16, #T_ef289_row6_col17, #T_ef289_row7_col0, #T_ef289_row7_col1, #T_ef289_row7_col2, #T_ef289_row7_col3, #T_ef289_row7_col4, #T_ef289_row7_col5, #T_ef289_row7_col6, #T_ef289_row7_col13, #T_ef289_row7_col14, #T_ef289_row7_col15, #T_ef289_row7_col16, #T_ef289_row7_col17, #T_ef289_row8_col0, #T_ef289_row8_col1, #T_ef289_row8_col2, #T_ef289_row8_col3, #T_ef289_row8_col4, #T_ef289_row8_col13, #T_ef289_row8_col14, #T_ef289_row8_col15, #T_ef289_row8_col16, #T_ef289_row8_col17, #T_ef289_row9_col0, #T_ef289_row9_col1, #T_ef289_row9_col2, #T_ef289_row9_col3, #T_ef289_row9_col4, #T_ef289_row9_col16, #T_ef289_row9_col17, #T_ef289_row10_col0, #T_ef289_row10_col1, #T_ef289_row10_col2, #T_ef289_row10_col3, #T_ef289_row10_col4, #T_ef289_row10_col5, #T_ef289_row10_col6, #T_ef289_row10_col17 {
  font-size: 6pt;
  background-color: #ffffff;
  color: #000000;
}
#T_ef289_row1_col5 {
  font-size: 6pt;
  background-color: #efefef;
  color: #000000;
}
#T_ef289_row1_col6, #T_ef289_row1_col13 {
  font-size: 6pt;
  background-color: #7c7c7c;
  color: #f1f1f1;
}
#T_ef289_row1_col7 {
  font-size: 6pt;
  background-color: #4a4a4a;
  color: #f1f1f1;
}
#T_ef289_row1_col8, #T_ef289_row1_col9, #T_ef289_row1_col10, #T_ef289_row2_col5, #T_ef289_row2_col6, #T_ef289_row2_col7, #T_ef289_row2_col11, #T_ef289_row2_col12, #T_ef289_row2_col13, #T_ef289_row3_col4, #T_ef289_row3_col12, #T_ef289_row3_col13, #T_ef289_row4_col1, #T_ef289_row4_col2, #T_ef289_row4_col3, #T_ef289_row4_col12, #T_ef289_row4_col13, #T_ef289_row5_col12, #T_ef289_row6_col11, #T_ef289_row9_col11, #T_ef289_row10_col11, #T_ef289_row10_col12, #T_ef289_row10_col13, #T_ef289_row10_col14, #T_ef289_row10_col15, #T_ef289_row10_col16 {
  font-size: 6pt;
  background-color: #000000;
  color: #f1f1f1;
}
#T_ef289_row1_col11 {
  font-size: 6pt;
  background-color: #606060;
  color: #f1f1f1;
}
#T_ef289_row1_col12 {
  font-size: 6pt;
  background-color: #4d4d4d;
  color: #f1f1f1;
}
#T_ef289_row1_col14 {
  font-size: 6pt;
  background-color: #bbbbbb;
  color: #000000;
}
#T_ef289_row2_col3 {
  font-size: 6pt;
  background-color: #e4e4e4;
  color: #000000;
}
#T_ef289_row2_col4, #T_ef289_row8_col6 {
  font-size: 6pt;
  background-color: #6b6b6b;
  color: #f1f1f1;
}
#T_ef289_row2_col8, #T_ef289_row2_col14, #T_ef289_row3_col14 {
  font-size: 6pt;
  background-color: #171717;
  color: #f1f1f1;
}
#T_ef289_row2_col9, #T_ef289_row3_col11 {
  font-size: 6pt;
  background-color: #4b4b4b;
  color: #f1f1f1;
}
#T_ef289_row2_col10, #T_ef289_row7_col10, #T_ef289_row8_col8, #T_ef289_row8_col10, #T_ef289_row9_col8, #T_ef289_row9_col10 {
  font-size: 6pt;
  background-color: #010101;
  color: #f1f1f1;
}
#T_ef289_row3_col1 {
  font-size: 6pt;
  background-color: #272727;
  color: #f1f1f1;
}
#T_ef289_row3_col2 {
  font-size: 6pt;
  background-color: #0a0a0a;
  color: #f1f1f1;
}
#T_ef289_row3_col3 {
  font-size: 6pt;
  background-color: #050505;
  color: #f1f1f1;
}
#T_ef289_row3_col5 {
  font-size: 6pt;
  background-color: #333333;
  color: #f1f1f1;
}
#T_ef289_row3_col6 {
  font-size: 6pt;
  background-color: #e6e6e6;
  color: #000000;
}
#T_ef289_row3_col7, #T_ef289_row3_col10 {
  font-size: 6pt;
  background-color: #fafafa;
  color: #000000;
}
#T_ef289_row3_col8 {
  font-size: 6pt;
  background-color: #fbfbfb;
  color: #000000;
}
#T_ef289_row3_col9 {
  font-size: 6pt;
  background-color: #fdfdfd;
  color: #000000;
}
#T_ef289_row4_col4 {
  font-size: 6pt;
  background-color: #1b1b1b;
  color: #f1f1f1;
}
#T_ef289_row4_col5 {
  font-size: 6pt;
  background-color: #e0e0e0;
  color: #000000;
}
#T_ef289_row4_col11 {
  font-size: 6pt;
  background-color: #4e4e4e;
  color: #f1f1f1;
}
#T_ef289_row4_col14 {
  font-size: 6pt;
  background-color: #767676;
  color: #f1f1f1;
}
#T_ef289_row5_col1 {
  font-size: 6pt;
  background-color: #fcfcfc;
  color: #000000;
}
#T_ef289_row5_col2, #T_ef289_row5_col3 {
  font-size: 6pt;
  background-color: #f6f6f6;
  color: #000000;
}
#T_ef289_row5_col4, #T_ef289_row7_col7 {
  font-size: 6pt;
  background-color: #f8f8f8;
  color: #000000;
}
#T_ef289_row5_col10, #T_ef289_row10_col7 {
  font-size: 6pt;
  background-color: #e8e8e8;
  color: #000000;
}
#T_ef289_row5_col11 {
  font-size: 6pt;
  background-color: #222222;
  color: #f1f1f1;
}
#T_ef289_row5_col13, #T_ef289_row6_col12 {
  font-size: 6pt;
  background-color: #090909;
  color: #f1f1f1;
}
#T_ef289_row5_col14 {
  font-size: 6pt;
  background-color: #d0d0d0;
  color: #000000;
}
#T_ef289_row6_col10, #T_ef289_row7_col11, #T_ef289_row9_col6 {
  font-size: 6pt;
  background-color: #060606;
  color: #f1f1f1;
}
#T_ef289_row6_col13 {
  font-size: 6pt;
  background-color: #979797;
  color: #f1f1f1;
}
#T_ef289_row7_col8 {
  font-size: 6pt;
  background-color: #b6b6b6;
  color: #000000;
}
#T_ef289_row7_col9 {
  font-size: 6pt;
  background-color: #252525;
  color: #f1f1f1;
}
#T_ef289_row7_col12 {
  font-size: 6pt;
  background-color: #999999;
  color: #f1f1f1;
}
#T_ef289_row8_col5 {
  font-size: 6pt;
  background-color: #f9f9f9;
  color: #000000;
}
#T_ef289_row8_col7 {
  font-size: 6pt;
  background-color: #101010;
  color: #f1f1f1;
}
#T_ef289_row8_col9, #T_ef289_row9_col9 {
  font-size: 6pt;
  background-color: #020202;
  color: #f1f1f1;
}
#T_ef289_row8_col11 {
  font-size: 6pt;
  background-color: #545454;
  color: #f1f1f1;
}
#T_ef289_row8_col12 {
  font-size: 6pt;
  background-color: #f1f1f1;
  color: #000000;
}
#T_ef289_row9_col5 {
  font-size: 6pt;
  background-color: #f7f7f7;
  color: #000000;
}
#T_ef289_row9_col7 {
  font-size: 6pt;
  background-color: #030303;
  color: #f1f1f1;
}
#T_ef289_row9_col12 {
  font-size: 6pt;
  background-color: #181818;
  color: #f1f1f1;
}
#T_ef289_row9_col13 {
  font-size: 6pt;
  background-color: #303030;
  color: #f1f1f1;
}
#T_ef289_row9_col14 {
  font-size: 6pt;
  background-color: #a9a9a9;
  color: #f1f1f1;
}
#T_ef289_row9_col15 {
  font-size: 6pt;
  background-color: #fefefe;
  color: #000000;
}
#T_ef289_row10_col8, #T_ef289_row10_col9 {
  font-size: 6pt;
  background-color: #bababa;
  color: #000000;
}
#T_ef289_row10_col10 {
  font-size: 6pt;
  background-color: #393939;
  color: #f1f1f1;
}
</style>
<table id="T_ef289">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_ef289_level0_col0" class="col_heading level0 col0" >0</th>
      <th id="T_ef289_level0_col1" class="col_heading level0 col1" >1</th>
      <th id="T_ef289_level0_col2" class="col_heading level0 col2" >2</th>
      <th id="T_ef289_level0_col3" class="col_heading level0 col3" >3</th>
      <th id="T_ef289_level0_col4" class="col_heading level0 col4" >4</th>
      <th id="T_ef289_level0_col5" class="col_heading level0 col5" >5</th>
      <th id="T_ef289_level0_col6" class="col_heading level0 col6" >6</th>
      <th id="T_ef289_level0_col7" class="col_heading level0 col7" >7</th>
      <th id="T_ef289_level0_col8" class="col_heading level0 col8" >8</th>
      <th id="T_ef289_level0_col9" class="col_heading level0 col9" >9</th>
      <th id="T_ef289_level0_col10" class="col_heading level0 col10" >10</th>
      <th id="T_ef289_level0_col11" class="col_heading level0 col11" >11</th>
      <th id="T_ef289_level0_col12" class="col_heading level0 col12" >12</th>
      <th id="T_ef289_level0_col13" class="col_heading level0 col13" >13</th>
      <th id="T_ef289_level0_col14" class="col_heading level0 col14" >14</th>
      <th id="T_ef289_level0_col15" class="col_heading level0 col15" >15</th>
      <th id="T_ef289_level0_col16" class="col_heading level0 col16" >16</th>
      <th id="T_ef289_level0_col17" class="col_heading level0 col17" >17</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_ef289_level0_row0" class="row_heading level0 row0" >0</th>
      <td id="T_ef289_row0_col0" class="data row0 col0" >0</td>
      <td id="T_ef289_row0_col1" class="data row0 col1" >0</td>
      <td id="T_ef289_row0_col2" class="data row0 col2" >0</td>
      <td id="T_ef289_row0_col3" class="data row0 col3" >0</td>
      <td id="T_ef289_row0_col4" class="data row0 col4" >0</td>
      <td id="T_ef289_row0_col5" class="data row0 col5" >0</td>
      <td id="T_ef289_row0_col6" class="data row0 col6" >0</td>
      <td id="T_ef289_row0_col7" class="data row0 col7" >0</td>
      <td id="T_ef289_row0_col8" class="data row0 col8" >0</td>
      <td id="T_ef289_row0_col9" class="data row0 col9" >0</td>
      <td id="T_ef289_row0_col10" class="data row0 col10" >0</td>
      <td id="T_ef289_row0_col11" class="data row0 col11" >0</td>
      <td id="T_ef289_row0_col12" class="data row0 col12" >0</td>
      <td id="T_ef289_row0_col13" class="data row0 col13" >0</td>
      <td id="T_ef289_row0_col14" class="data row0 col14" >0</td>
      <td id="T_ef289_row0_col15" class="data row0 col15" >0</td>
      <td id="T_ef289_row0_col16" class="data row0 col16" >0</td>
      <td id="T_ef289_row0_col17" class="data row0 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_ef289_row1_col0" class="data row1 col0" >0</td>
      <td id="T_ef289_row1_col1" class="data row1 col1" >0</td>
      <td id="T_ef289_row1_col2" class="data row1 col2" >0</td>
      <td id="T_ef289_row1_col3" class="data row1 col3" >0</td>
      <td id="T_ef289_row1_col4" class="data row1 col4" >0</td>
      <td id="T_ef289_row1_col5" class="data row1 col5" >29</td>
      <td id="T_ef289_row1_col6" class="data row1 col6" >150</td>
      <td id="T_ef289_row1_col7" class="data row1 col7" >195</td>
      <td id="T_ef289_row1_col8" class="data row1 col8" >254</td>
      <td id="T_ef289_row1_col9" class="data row1 col9" >255</td>
      <td id="T_ef289_row1_col10" class="data row1 col10" >254</td>
      <td id="T_ef289_row1_col11" class="data row1 col11" >176</td>
      <td id="T_ef289_row1_col12" class="data row1 col12" >193</td>
      <td id="T_ef289_row1_col13" class="data row1 col13" >150</td>
      <td id="T_ef289_row1_col14" class="data row1 col14" >96</td>
      <td id="T_ef289_row1_col15" class="data row1 col15" >0</td>
      <td id="T_ef289_row1_col16" class="data row1 col16" >0</td>
      <td id="T_ef289_row1_col17" class="data row1 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row2" class="row_heading level0 row2" >2</th>
      <td id="T_ef289_row2_col0" class="data row2 col0" >0</td>
      <td id="T_ef289_row2_col1" class="data row2 col1" >0</td>
      <td id="T_ef289_row2_col2" class="data row2 col2" >0</td>
      <td id="T_ef289_row2_col3" class="data row2 col3" >48</td>
      <td id="T_ef289_row2_col4" class="data row2 col4" >166</td>
      <td id="T_ef289_row2_col5" class="data row2 col5" >224</td>
      <td id="T_ef289_row2_col6" class="data row2 col6" >253</td>
      <td id="T_ef289_row2_col7" class="data row2 col7" >253</td>
      <td id="T_ef289_row2_col8" class="data row2 col8" >234</td>
      <td id="T_ef289_row2_col9" class="data row2 col9" >196</td>
      <td id="T_ef289_row2_col10" class="data row2 col10" >253</td>
      <td id="T_ef289_row2_col11" class="data row2 col11" >253</td>
      <td id="T_ef289_row2_col12" class="data row2 col12" >253</td>
      <td id="T_ef289_row2_col13" class="data row2 col13" >253</td>
      <td id="T_ef289_row2_col14" class="data row2 col14" >233</td>
      <td id="T_ef289_row2_col15" class="data row2 col15" >0</td>
      <td id="T_ef289_row2_col16" class="data row2 col16" >0</td>
      <td id="T_ef289_row2_col17" class="data row2 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row3" class="row_heading level0 row3" >3</th>
      <td id="T_ef289_row3_col0" class="data row3 col0" >0</td>
      <td id="T_ef289_row3_col1" class="data row3 col1" >93</td>
      <td id="T_ef289_row3_col2" class="data row3 col2" >244</td>
      <td id="T_ef289_row3_col3" class="data row3 col3" >249</td>
      <td id="T_ef289_row3_col4" class="data row3 col4" >253</td>
      <td id="T_ef289_row3_col5" class="data row3 col5" >187</td>
      <td id="T_ef289_row3_col6" class="data row3 col6" >46</td>
      <td id="T_ef289_row3_col7" class="data row3 col7" >10</td>
      <td id="T_ef289_row3_col8" class="data row3 col8" >8</td>
      <td id="T_ef289_row3_col9" class="data row3 col9" >4</td>
      <td id="T_ef289_row3_col10" class="data row3 col10" >10</td>
      <td id="T_ef289_row3_col11" class="data row3 col11" >194</td>
      <td id="T_ef289_row3_col12" class="data row3 col12" >253</td>
      <td id="T_ef289_row3_col13" class="data row3 col13" >253</td>
      <td id="T_ef289_row3_col14" class="data row3 col14" >233</td>
      <td id="T_ef289_row3_col15" class="data row3 col15" >0</td>
      <td id="T_ef289_row3_col16" class="data row3 col16" >0</td>
      <td id="T_ef289_row3_col17" class="data row3 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row4" class="row_heading level0 row4" >4</th>
      <td id="T_ef289_row4_col0" class="data row4 col0" >0</td>
      <td id="T_ef289_row4_col1" class="data row4 col1" >107</td>
      <td id="T_ef289_row4_col2" class="data row4 col2" >253</td>
      <td id="T_ef289_row4_col3" class="data row4 col3" >253</td>
      <td id="T_ef289_row4_col4" class="data row4 col4" >230</td>
      <td id="T_ef289_row4_col5" class="data row4 col5" >48</td>
      <td id="T_ef289_row4_col6" class="data row4 col6" >0</td>
      <td id="T_ef289_row4_col7" class="data row4 col7" >0</td>
      <td id="T_ef289_row4_col8" class="data row4 col8" >0</td>
      <td id="T_ef289_row4_col9" class="data row4 col9" >0</td>
      <td id="T_ef289_row4_col10" class="data row4 col10" >0</td>
      <td id="T_ef289_row4_col11" class="data row4 col11" >192</td>
      <td id="T_ef289_row4_col12" class="data row4 col12" >253</td>
      <td id="T_ef289_row4_col13" class="data row4 col13" >253</td>
      <td id="T_ef289_row4_col14" class="data row4 col14" >156</td>
      <td id="T_ef289_row4_col15" class="data row4 col15" >0</td>
      <td id="T_ef289_row4_col16" class="data row4 col16" >0</td>
      <td id="T_ef289_row4_col17" class="data row4 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row5" class="row_heading level0 row5" >5</th>
      <td id="T_ef289_row5_col0" class="data row5 col0" >0</td>
      <td id="T_ef289_row5_col1" class="data row5 col1" >3</td>
      <td id="T_ef289_row5_col2" class="data row5 col2" >20</td>
      <td id="T_ef289_row5_col3" class="data row5 col3" >20</td>
      <td id="T_ef289_row5_col4" class="data row5 col4" >15</td>
      <td id="T_ef289_row5_col5" class="data row5 col5" >0</td>
      <td id="T_ef289_row5_col6" class="data row5 col6" >0</td>
      <td id="T_ef289_row5_col7" class="data row5 col7" >0</td>
      <td id="T_ef289_row5_col8" class="data row5 col8" >0</td>
      <td id="T_ef289_row5_col9" class="data row5 col9" >0</td>
      <td id="T_ef289_row5_col10" class="data row5 col10" >43</td>
      <td id="T_ef289_row5_col11" class="data row5 col11" >224</td>
      <td id="T_ef289_row5_col12" class="data row5 col12" >253</td>
      <td id="T_ef289_row5_col13" class="data row5 col13" >245</td>
      <td id="T_ef289_row5_col14" class="data row5 col14" >74</td>
      <td id="T_ef289_row5_col15" class="data row5 col15" >0</td>
      <td id="T_ef289_row5_col16" class="data row5 col16" >0</td>
      <td id="T_ef289_row5_col17" class="data row5 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row6" class="row_heading level0 row6" >6</th>
      <td id="T_ef289_row6_col0" class="data row6 col0" >0</td>
      <td id="T_ef289_row6_col1" class="data row6 col1" >0</td>
      <td id="T_ef289_row6_col2" class="data row6 col2" >0</td>
      <td id="T_ef289_row6_col3" class="data row6 col3" >0</td>
      <td id="T_ef289_row6_col4" class="data row6 col4" >0</td>
      <td id="T_ef289_row6_col5" class="data row6 col5" >0</td>
      <td id="T_ef289_row6_col6" class="data row6 col6" >0</td>
      <td id="T_ef289_row6_col7" class="data row6 col7" >0</td>
      <td id="T_ef289_row6_col8" class="data row6 col8" >0</td>
      <td id="T_ef289_row6_col9" class="data row6 col9" >0</td>
      <td id="T_ef289_row6_col10" class="data row6 col10" >249</td>
      <td id="T_ef289_row6_col11" class="data row6 col11" >253</td>
      <td id="T_ef289_row6_col12" class="data row6 col12" >245</td>
      <td id="T_ef289_row6_col13" class="data row6 col13" >126</td>
      <td id="T_ef289_row6_col14" class="data row6 col14" >0</td>
      <td id="T_ef289_row6_col15" class="data row6 col15" >0</td>
      <td id="T_ef289_row6_col16" class="data row6 col16" >0</td>
      <td id="T_ef289_row6_col17" class="data row6 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row7" class="row_heading level0 row7" >7</th>
      <td id="T_ef289_row7_col0" class="data row7 col0" >0</td>
      <td id="T_ef289_row7_col1" class="data row7 col1" >0</td>
      <td id="T_ef289_row7_col2" class="data row7 col2" >0</td>
      <td id="T_ef289_row7_col3" class="data row7 col3" >0</td>
      <td id="T_ef289_row7_col4" class="data row7 col4" >0</td>
      <td id="T_ef289_row7_col5" class="data row7 col5" >0</td>
      <td id="T_ef289_row7_col6" class="data row7 col6" >0</td>
      <td id="T_ef289_row7_col7" class="data row7 col7" >14</td>
      <td id="T_ef289_row7_col8" class="data row7 col8" >101</td>
      <td id="T_ef289_row7_col9" class="data row7 col9" >223</td>
      <td id="T_ef289_row7_col10" class="data row7 col10" >253</td>
      <td id="T_ef289_row7_col11" class="data row7 col11" >248</td>
      <td id="T_ef289_row7_col12" class="data row7 col12" >124</td>
      <td id="T_ef289_row7_col13" class="data row7 col13" >0</td>
      <td id="T_ef289_row7_col14" class="data row7 col14" >0</td>
      <td id="T_ef289_row7_col15" class="data row7 col15" >0</td>
      <td id="T_ef289_row7_col16" class="data row7 col16" >0</td>
      <td id="T_ef289_row7_col17" class="data row7 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row8" class="row_heading level0 row8" >8</th>
      <td id="T_ef289_row8_col0" class="data row8 col0" >0</td>
      <td id="T_ef289_row8_col1" class="data row8 col1" >0</td>
      <td id="T_ef289_row8_col2" class="data row8 col2" >0</td>
      <td id="T_ef289_row8_col3" class="data row8 col3" >0</td>
      <td id="T_ef289_row8_col4" class="data row8 col4" >0</td>
      <td id="T_ef289_row8_col5" class="data row8 col5" >11</td>
      <td id="T_ef289_row8_col6" class="data row8 col6" >166</td>
      <td id="T_ef289_row8_col7" class="data row8 col7" >239</td>
      <td id="T_ef289_row8_col8" class="data row8 col8" >253</td>
      <td id="T_ef289_row8_col9" class="data row8 col9" >253</td>
      <td id="T_ef289_row8_col10" class="data row8 col10" >253</td>
      <td id="T_ef289_row8_col11" class="data row8 col11" >187</td>
      <td id="T_ef289_row8_col12" class="data row8 col12" >30</td>
      <td id="T_ef289_row8_col13" class="data row8 col13" >0</td>
      <td id="T_ef289_row8_col14" class="data row8 col14" >0</td>
      <td id="T_ef289_row8_col15" class="data row8 col15" >0</td>
      <td id="T_ef289_row8_col16" class="data row8 col16" >0</td>
      <td id="T_ef289_row8_col17" class="data row8 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row9" class="row_heading level0 row9" >9</th>
      <td id="T_ef289_row9_col0" class="data row9 col0" >0</td>
      <td id="T_ef289_row9_col1" class="data row9 col1" >0</td>
      <td id="T_ef289_row9_col2" class="data row9 col2" >0</td>
      <td id="T_ef289_row9_col3" class="data row9 col3" >0</td>
      <td id="T_ef289_row9_col4" class="data row9 col4" >0</td>
      <td id="T_ef289_row9_col5" class="data row9 col5" >16</td>
      <td id="T_ef289_row9_col6" class="data row9 col6" >248</td>
      <td id="T_ef289_row9_col7" class="data row9 col7" >250</td>
      <td id="T_ef289_row9_col8" class="data row9 col8" >253</td>
      <td id="T_ef289_row9_col9" class="data row9 col9" >253</td>
      <td id="T_ef289_row9_col10" class="data row9 col10" >253</td>
      <td id="T_ef289_row9_col11" class="data row9 col11" >253</td>
      <td id="T_ef289_row9_col12" class="data row9 col12" >232</td>
      <td id="T_ef289_row9_col13" class="data row9 col13" >213</td>
      <td id="T_ef289_row9_col14" class="data row9 col14" >111</td>
      <td id="T_ef289_row9_col15" class="data row9 col15" >2</td>
      <td id="T_ef289_row9_col16" class="data row9 col16" >0</td>
      <td id="T_ef289_row9_col17" class="data row9 col17" >0</td>
    </tr>
    <tr>
      <th id="T_ef289_level0_row10" class="row_heading level0 row10" >10</th>
      <td id="T_ef289_row10_col0" class="data row10 col0" >0</td>
      <td id="T_ef289_row10_col1" class="data row10 col1" >0</td>
      <td id="T_ef289_row10_col2" class="data row10 col2" >0</td>
      <td id="T_ef289_row10_col3" class="data row10 col3" >0</td>
      <td id="T_ef289_row10_col4" class="data row10 col4" >0</td>
      <td id="T_ef289_row10_col5" class="data row10 col5" >0</td>
      <td id="T_ef289_row10_col6" class="data row10 col6" >0</td>
      <td id="T_ef289_row10_col7" class="data row10 col7" >43</td>
      <td id="T_ef289_row10_col8" class="data row10 col8" >98</td>
      <td id="T_ef289_row10_col9" class="data row10 col9" >98</td>
      <td id="T_ef289_row10_col10" class="data row10 col10" >208</td>
      <td id="T_ef289_row10_col11" class="data row10 col11" >253</td>
      <td id="T_ef289_row10_col12" class="data row10 col12" >253</td>
      <td id="T_ef289_row10_col13" class="data row10 col13" >253</td>
      <td id="T_ef289_row10_col14" class="data row10 col14" >253</td>
      <td id="T_ef289_row10_col15" class="data row10 col15" >187</td>
      <td id="T_ef289_row10_col16" class="data row10 col16" >22</td>
      <td id="T_ef289_row10_col17" class="data row10 col17" >0</td>
    </tr>
  </tbody>
</table>
#+end_export

#+begin_src jupyter-python :results raw
  seven_tensors = [tensor(Image.open(o)) for o in sevens]
  three_tensors = [tensor(Image.open(o)) for o in threes]
  len(three_tensors), len(seven_tensors)
#+end_src

#+RESULTS:
| 6131 | 6265 |

#+begin_src jupyter-python
  show_image(three_tensors[1])
#+end_src

#+RESULTS:
:RESULTS:
: <Axes: >
[[file:./.ob-jupyter/012952cb22921d3b43366091f2c833d0dd1cdcbd.png]]
:END:

#+begin_src jupyter-python
  stacked_sevens = torch.stack(seven_tensors).float() / 255
  stacked_threes = torch.stack(three_tensors).float() / 255
  stacked_threes.shape
#+end_src

#+RESULTS:
: torch.Size([6131, 28, 28])

** Length of a tensor's shape is its rank
#+begin_src jupyter-python
len(stacked_threes.shape)
#+end_src

#+RESULTS:
: 3

** A tensor's rank can also be retrieved using ndim
#+begin_src jupyter-python
stacked_threes.ndim
#+end_src

#+RESULTS:
: 3

** Mean of all the image tensors
#+begin_src jupyter-python
  mean3 = stacked_threes.mean(0)
  show_image(mean3)
#+end_src

#+RESULTS:
:RESULTS:
: <Axes: >
[[file:./.ob-jupyter/74f2b5dbf18c2296d88f525c15cd8c2fa15dcb96.png]]
:END:

** Mean of 7
#+begin_src jupyter-python
  mean7 = stacked_sevens.mean(0)
  show_image(mean7)
#+end_src

#+RESULTS:
:RESULTS:
: <Axes: >
[[file:./.ob-jupyter/32ab60e1e4eb1a100b7f2d3fad124240a205a3c1.png]]
:END:

** Sample 3
#+begin_src jupyter-python
  a_3 = stacked_threes[1]
  show_image(a_3)
#+end_src

#+RESULTS:
:RESULTS:
: <Axes: >
[[file:./.ob-jupyter/012952cb22921d3b43366091f2c833d0dd1cdcbd.png]]
:END:

** a_3 distances from mean3
#+begin_src jupyter-python
  dist_3_abs = (a_3 - mean3).abs().mean()
  dist_3_sqr = ((a_3 - mean3) ** 2).mean().sqrt()
  print(dist_3_abs, dist_3_sqr)
#+end_src

#+RESULTS:
: tensor(0.1114) tensor(0.2021)

** a_3 distances from mean7
#+begin_src jupyter-python
  dist_7_abs = (a_3 - mean7).abs().mean()
  dist_7_sqr = ((a_3 - mean7) ** 2).mean().sqrt()
  print(dist_7_abs, dist_7_sqr)
#+end_src

#+RESULTS:
: tensor(0.1586) tensor(0.3021)

#+begin_src jupyter-python
  print(F.l1_loss(a_3.float(),mean7), F.mse_loss(a_3,mean7).sqrt())
#+end_src

#+RESULTS:
: tensor(0.1586) tensor(0.3021)


